var Arrow=pc.createScript("arrow");Arrow.prototype.initialize=function(){},Arrow.prototype.update=function(r){};var TweenPosition=pc.createScript("tweenPosition");TweenPosition.attributes.add("duration",{type:"number",default:1}),TweenPosition.attributes.add("easing",{type:"string",default:"Linear"}),TweenPosition.attributes.add("delay",{type:"number",default:0}),TweenPosition.attributes.add("loop",{type:"boolean",default:!0}),TweenPosition.attributes.add("yoyo",{type:"boolean",default:!1}),TweenPosition.attributes.add("repeat",{type:"number",default:2}),TweenPosition.prototype.initialize=function(){this.reset(),this.on("attr:duration",(function(t){this.tween.duration=t}),this),this.on("attr:easing",this.reset,this),this.on("attr:delay",this.reset,this),this.on("attr:loop",this.reset,this),this.on("attr:yoyo",this.reset,this),this.on("attr:repeat",this.reset,this)},TweenPosition.prototype.reset=function(){this.tween&&this.tween.stop(),this.tween=this.entity.tween(this.entity.getLocalPosition()).to(new pc.Vec3(-5.944,-1.7,-9.487),this.duration,pc[this.easing]).delay(this.delay).loop(this.loop).yoyo(this.yoyo),this.loop||this.tween.repeat(this.repeat),this.tween.start()};var TextTween=pc.createScript("textTween");TextTween.attributes.add("duration",{type:"number",default:1}),TextTween.attributes.add("easing",{type:"string",default:"Linear"}),TextTween.attributes.add("delay",{type:"number",default:0}),TextTween.attributes.add("loop",{type:"boolean",default:!0}),TextTween.attributes.add("yoyo",{type:"boolean",default:!1}),TextTween.attributes.add("repeat",{type:"number",default:2}),TextTween.prototype.initialize=function(){this.reset(),this.on("attr:duration",(function(t){this.tween.duration=t}),this),this.on("attr:easing",this.reset,this),this.on("attr:delay",this.reset,this),this.on("attr:loop",this.reset,this),this.on("attr:yoyo",this.reset,this),this.on("attr:repeat",this.reset,this)},TextTween.prototype.reset=function(){this.tween&&this.tween.stop(),this.tween=this.entity.tween(this.entity.getLocalPosition()).to(new pc.Vec3(-1.739,8.913,28.02),this.duration,pc[this.easing]).delay(this.delay).loop(this.loop).yoyo(this.yoyo),this.loop||this.tween.repeat(this.repeat),this.tween.start()};var CannonWorld=pc.createScript("cannonWorld");CannonWorld.attributes.add("fixedTimeStep",{type:"number",default:.016666,title:"Fixed Time Step"}),CannonWorld.attributes.add("iterations",{type:"number",default:3,title:"Iterations"}),CannonWorld.attributes.add("gravity",{type:"vec3",default:[0,-9.8,0],title:"Gravity"}),CannonWorld.attributes.add("debugMode",{type:"boolean",title:"Debug Mode"}),CannonWorld.BODYTYPE_STATIC=0,CannonWorld.BODYTYPE_DYNAMIC=1,CannonWorld.BODYTYPE_KINEMATIC=2,CannonWorld.BODYTYPE_TRIGGER=3,CannonWorld.EVENT_COLLISION_START="collisionstart",CannonWorld.EVENT_COLLISION_END="collisionend",CannonWorld.EVENT_TRIGGER_ENTER="triggerenter",CannonWorld.EVENT_TRIGGER_LEAVE="triggerleave",CannonWorld.prototype.initialize=function(){this.app.cannonWorld?console.warn("An Cannon world has already been created. Not creating a new one."):(this.world=new CANNON.World,this.world.gravity.set(this.gravity.x,this.gravity.y,this.gravity.z),this.world.addEventListener("beginContact",this._onBeginContact.bind(this)),this.world.addEventListener("endContact",this._onEndContact.bind(this)),this.app.cannonWorld=this,this._rigidbodies=[],pc.ComponentSystem.bind("update",this._update,this),this.on("destroy",(function(){pc.ComponentSystem.unbind("update",this._update,this),this._rigidbodies=[],this.world=null,this.app.cannonWorld=null}),this))},CannonWorld.prototype._update=function(){var n=new pc.Quat;return function(t){var o,e,i;for(this.world.step(this.fixedTimeStep,t,this.iterations),o=0;o<this._rigidbodies.length;++o){var a=this._rigidbodies[o];a.body.sleepState!==CANNON.Body.SLEEPING&&(a.body.type===CANNON.Body.STATIC?(e=a.entity.getPosition(),i=a.entity.getRotation(),a.body.position.set(e.x,e.y,e.z),a.body.quaternion.set(i.x,i.y,i.z,i.w)):(e=a.body.position,i=a.body.quaternion,a.entity.setPosition(e.x,e.y,e.z),n.set(i.x,i.y,i.z,i.w||1),a.entity.setRotation(n)))}}}(),CannonWorld.prototype._onBeginContact=function(){var n={other:null};return function(t){var o=t.bodyA,e=t.bodyB,i=o&&o.sensor||e&&e.sensor?CannonWorld.EVENT_TRIGGER_ENTER:CannonWorld.EVENT_COLLISION_START;n.other=e.entity,o.entity.fire(i,n),n.other=o.entity,e.entity.fire(i,n)}}(),CannonWorld.prototype._onEndContact=function(){var n={other:null};return function(t){var o=t.bodyA,e=t.bodyB,i=o&&o.sensor||e&&e.sensor?CannonWorld.EVENT_TRIGGER_LEAVE:CannonWorld.EVENT_COLLISION_END;n.other=e&&e.entity,o&&o.entity.fire(i,n),n.other=o&&o.entity,e&&e.entity.fire(i,n)}}(),CannonWorld.prototype._addRigidbody=function(n){this.world.addBody(n.cannonBody),this._rigidbodies.push({body:n.cannonBody,entity:n})},CannonWorld.prototype._removeRigidbody=function(n){var t;for(t=0;t<this._rigidbodies.length;++t){var o=this._rigidbodies[t];if(n.cannonBody===o.body){this._rigidbodies.splice(t,1);break}}this.world.removeBody(n.cannonBody)},CannonWorld.prototype._addShape=function(n,t,o,e){var i=n.entity.getPosition(),a=n.entity.getRotation();e!==CannonWorld.BODYTYPE_STATIC&&e!==CannonWorld.BODYTYPE_TRIGGER||(o=0),n.body=new CANNON.Body({mass:o,position:new CANNON.Vec3(i.x,i.y,i.z),quaternion:new CANNON.Quaternion(a.x,a.y,a.z,a.w),shape:t,sensor:e===CannonWorld.BODYTYPE_TRIGGER}),e===CannonWorld.BODYTYPE_KINEMATIC&&(n.body.type=CANNON.Body.KINEMATIC),n.entity.cannonBody=n.body,n.body.entity=n.entity,this._addRigidbody(n.entity),n.on("destroy",(function(){this.app.cannonWorld._removeRigidbody(this.entity),this.entity.cannonBody=null,this.body=null}),n),n.on("state",(function(n){n?this.app.cannonWorld._addRigidbody(this.entity):this.app.cannonWorld._removeRigidbody(this.entity)}),n)},CannonWorld.prototype.teleport=function(n,t,o){n.cannonBody.position.set(t.x,t.y,t.z),o&&n.cannonBody.quaternion.set(o.x,o.y,o.z,o.w),n.cannonBody.velocity.set(0,0,0),n.cannonBody.angularVelocity.set(0,0,0)},CannonWorld.prototype.raycastFirst=function(){if(window.CANNON)var n=new CANNON.RaycastResult,t={entity:null,normal:new pc.Vec3,point:new pc.Vec3},o=new CANNON.Vec3,e=new CANNON.Vec3,i={};return function(a,r){return o.set(a.x,a.y,a.z),e.set(r.x,r.y,r.z),this.world.raycastClosest(o,e,i,n),n.hasHit?(t.entity=n.body.entity,t.normal.set(n.hitNormalWorld.x,n.hitNormalWorld.y,n.hitNormalWorld.x),t.point.set(n.hitPointWorld.x,n.hitPointWorld.y,n.hitPointWorld.z),t):null}}(),CannonWorld.prototype.raycastAll=function(){if(window.CANNON)var n=[],t=new CANNON.Vec3,o=new CANNON.Vec3,e={};var cannonCallback=function(t){var o={};o.entity=t.body.entity,o.normal=new pc.Vec3(t.hitNormalWorld.x,t.hitNormalWorld.y,t.hitNormalWorld.x),o.point=new pc.Vec3(t.hitPointWorld.x,t.hitPointWorld.y,t.hitPointWorld.z),n.push(o)};return function(i,a){return n.length=0,t.set(i.x,i.y,i.z),o.set(a.x,a.y,a.z),this.world.raycastAll(t,o,e,cannonCallback),n}}();var CannonHelper={addCannonBodyDefaults:function(n){n.attributes.add("mass",{type:"number",default:1,title:"Mass"}),n.attributes.add("type",{type:"number",default:CannonWorld.BODYTYPE_DYNAMIC,title:"Type",enum:[{Static:CannonWorld.BODYTYPE_STATIC},{Dynamic:CannonWorld.BODYTYPE_DYNAMIC},{Kinematic:CannonWorld.BODYTYPE_KINEMATIC},{Trigger:CannonWorld.BODYTYPE_TRIGGER}]})}},CannonBox=pc.createScript("cannonBox");CannonHelper.addCannonBodyDefaults(CannonBox),CannonBox.attributes.add("halfExtents",{type:"vec3",default:[.5,.5,.5],title:"Half Extents"}),CannonBox.prototype.postInitialize=function(){if(this.app.cannonWorld){var n=new CANNON.Box(new CANNON.Vec3(this.halfExtents.x,this.halfExtents.y,this.halfExtents.z));this.app.cannonWorld._addShape(this,n,this.mass,this.type)}};var CannonSphere=pc.createScript("cannonSphere");CannonHelper.addCannonBodyDefaults(CannonSphere),CannonSphere.attributes.add("radius",{type:"number",default:.5,title:"Radius"}),CannonSphere.prototype.postInitialize=function(){if(this.app.cannonWorld){var n=new CANNON.Sphere(this.radius);this.app.cannonWorld._addShape(this,n,this.mass,this.type)}};var CannonCylinder=pc.createScript("cannonCylinder");CannonHelper.addCannonBodyDefaults(CannonCylinder),CannonCylinder.attributes.add("radius",{type:"number",default:.5,title:"Radius"}),CannonCylinder.attributes.add("height",{type:"number",default:1,title:"Height"}),CannonCylinder.attributes.add("segmentCount",{type:"number",default:8,title:"Segment Count"}),CannonCylinder.prototype.postInitialize=function(){if(this.app.cannonWorld){var n=new CANNON.Cylinder(this.radius,this.radius,this.height,this.segmentCount);this.app.cannonWorld._addShape(this,n,this.mass,this.type)}};var DragRollTarget=pc.createScript("dragRollTarget");DragRollTarget.prototype.initialize=function(){this.entity.dragRollTarget=!0},DragRollTarget.prototype.update=function(t){};var DragRoll=pc.createScript("dragRoll");DragRoll.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),DragRoll.attributes.add("floorEntity",{type:"entity",title:"Floor Entity"}),DragRoll.attributes.add("arrowEntity",{type:"entity",title:"Arrow Entity"}),DragRoll.attributes.add("maxForce",{type:"number",title:"Max Force",description:"Maximum clamp value for ball force",default:10}),DragRoll.attributes.add("minForce",{type:"number",title:"Min Force",description:"Minimum clamp value for ball force",default:3.5}),DragRoll.attributes.add("dragVelXMultiplier",{type:"number",title:"Drag Vel X Multiplier",description:"Drag velocity factor - x axis",default:.05}),DragRoll.attributes.add("dragVelZMultiplier",{type:"number",title:"Drag Vel Z Multiplier",description:"Drag velocity factor - z axis",default:.1}),console.log("drag_roll"),DragRoll.prototype.initialize=function(){this.ray=new pc.Ray,this.dragging=this.rolling=!1,this.enabled=!0,this.resetArrow=this.resetArrow.bind(this),this.app.touch?(this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStartHandler,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.touchEndHandler,this)):this.app.mouse&&(this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDownHandler,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.mouseUpHandler,this)),this.app.mouse.disableContextMenu(),this.app.keyboard.on(pc.EVENT_KEYDOWN,this.resetPosition,this),this.entity.on("teleportable:reposition",this.repositionHandler,this)},DragRoll.prototype.update=function(){!0===this.rolling&&0===this.entity.rigidbody.linearVelocity.z&&this.entity.rigidbody.applyImpulse(new pc.Vec3(-.5,-10,-.5))},DragRoll.prototype.resetPosition=function(t){!0===this.enabled&&t.key===pc.KEY_R&&this.entity.setPosition(0,0,0),t.event.preventDefault()},DragRoll.prototype.repositionHandler=function(t){var i=this.entity.getPosition();this.cursorVelArray=[],this.side0=this.side1=0,this.app.fire("app:ballReturned"),this.arrowEntity.setPosition(i.x,this.arrowEntity.getPosition().y,i.z),this.rolling=!1},DragRoll.prototype.touchStartHandler=function(t){!1!==this.enabled&&(this.app.touch.on(pc.EVENT_TOUCHMOVE,this.cursorMoveHandler,this),this.cursorMoveHandler(t.touches[0]),t.event.preventDefault())},DragRoll.prototype.mouseDownHandler=function(t){!1!==this.enabled&&t.button===pc.MOUSEBUTTON_LEFT&&(this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.cursorMoveHandler,this),this.cursorMoveHandler(t))},DragRoll.prototype.touchEndHandler=function(t){this.app.touch.off(pc.EVENT_TOUCHMOVE,this.cursorMoveHandler,this),this.endDrag(t.changedTouches[0].x,t.changedTouches[0].y),t.event.preventDefault()},DragRoll.prototype.mouseUpHandler=function(t){t.button===pc.MOUSEBUTTON_LEFT&&(this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.cursorMoveHandler,this),this.endDrag(t.x,t.y))},DragRoll.prototype.cursorMoveHandler=function(t){this.app.touch?this.doRayCast(t.changedTouches?t.changedTouches[0]:t):this.doRayCast(t),this.dragging=!0},DragRoll.prototype.doRayCast=function(t){if(!0!==this.rolling&&!1!==this.enabled){var i=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip),e=this.app.systems.rigidbody.raycastFirst(this.cameraEntity.getPosition(),i);if(e&&!0===e.entity.dragRollTarget){var r=e.point,o=this.arrowEntity.getPosition();this.side0=r.x-o.x,this.side1=r.z-o.z;var a=o.distance(r),s=(90+180*Math.asin(this.side1/a)/Math.PI)*(r.x>o.x?-1:1);s>=-25&&s<=25&&(this.arrowEntity.setLocalScale(.75*a,1,1.8*a),this.arrowEntity.setLocalEulerAngles(0,s,0))}}},DragRoll.prototype.endDrag=function(t,i){!1===this.dragging||!0===this.rolling||!1===this.enabled||0===this.side0&&0===this.side1||(this.entity.rigidbody.applyImpulse(new pc.Vec3(this.side0*this.dragVelXMultiplier,0,pc.math.clamp(this.side1*this.dragVelZMultiplier,-this.maxForce,-this.minForce))),setTimeout(this.resetArrow,1e3),this.rolling=!0,this.dragging=!1)},DragRoll.prototype.resetArrow=function(){this.arrowEntity.setLocalScale(1,1,1),this.arrowEntity.setLocalEulerAngles(0,0,0)};var Boot=pc.createScript("boot");Boot.prototype.initialize=function(){void 0!==window.MobileFuse||"playcanv.as"!=window.location.hostname&&"launch.playcanvas.com"!==window.location.hostname||(window.MobileFuse={PC_CONFIG:{testing:!0,spanish:!1,textures:{imageFolder:"https://d3tj5wcy4685ia.cloudfront.net/FLLottery_SkeeBall/",imageNames:["screen.jpg"],changeOnSpin:!1,emissive:!1}},sendMessage:function(t){}}),this.MODEL_TAGS=["HyperCube","HyperPlane","OrientationCylinder","screenPlane"],this.baseEntityTexturesLoaded=0,this.canvasFound=!1,this.checkForCanvas=this.checkForCanvas.bind(this),this.app.on("textures:ready",this.texturesReadyHandler,this),this.findBaseEntities(),this.buildStyles(),this.checkForCanvas()},Boot.prototype.findBaseEntities=function(){this.baseEntitiesArray=[];for(var t=0;t<this.MODEL_TAGS.length;t++)this.baseEntitiesArray=this.baseEntitiesArray.concat(this.app.root.findByTag(this.MODEL_TAGS[t]))},Boot.prototype.checkForCanvas=function(){try{this.canvas=document.getElementsByTagName("canvas")[0],this.canvas.classList.add("app-canvas"),this.canvasFound=!0,this.checkReady()}catch(t){setTimeout(this.checkForCanvas,100)}},Boot.prototype.texturesReadyHandler=function(){this.baseEntityTexturesLoaded++,window.MobileFuse.PC_BOOT=!0,this.checkReady()},Boot.prototype.checkReady=function(){!0===this.canvasFound&&this.baseEntityTexturesLoaded===this.baseEntitiesArray.length&&this.alertReady()},Boot.prototype.alertReady=function(){this.canvas.classList.add("visible"),this.app.fire("Boot:ready",this);for(var t=0;t<this.baseEntitiesArray.length;t++){var e=!0,i=this.baseEntitiesArray[t];try{e=void 0!==window.MobileFuse.PC_CONFIG.animation&&window.MobileFuse.PC_CONFIG.animation.loops>0}catch(t){}e&&void 0!==i.openingAnimation&&setTimeout(i.openingAnimation.bind(i),600)}},Boot.prototype.buildStyles=function(){var t=document.createElement("style"),e=[".app-canvas {","    opacity: 0;","}",".app-canvas.visible {","     opacity: 1;","    -webkit-transition: opacity .5s;","    -moz-transition: opacity .5s;","    -ms-transition: opacity .5s;","    -o-transition: opacity .5s;","    transition: opacity .5s;","}"].join("\n");t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),document.head.appendChild(t)};var Clickable=pc.createScript("clickable");Clickable.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Clickable.prototype.initialize=function(){this.app.touch?this.app.touch.on(pc.EVENT_TOUCHSTART,this.clickHandler,this):this.app.mouse&&this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.clickHandler,this)},Clickable.prototype.clickHandler=function(t){this.doRayCast(t.changedTouches?t.changedTouches[0]:t)};var Teleportable=pc.createScript("teleportable");Teleportable.prototype.initialize=function(){this.lastTeleportFrom=null,this.lastTeleportTo=null,this.lastTeleport=Date.now(),this.startPosition=this.entity.getPosition().clone(),this.app.on("app:teleportRequest",this.teleportRequestReceivedHandler,this)},Teleportable.prototype.update=function(t){this.entity.getPosition().y<1&&this.teleport(this.lastTeleportFrom,this.lastTeleportTo,!0)},Teleportable.prototype.teleportRequestReceivedHandler=function(t){t===this.entity&&this.teleport(this.lastTeleportFrom,this.lastTeleportTo)},Teleportable.prototype.teleport=function(t,e,i){var o=new pc.Vec3;if(!(t&&Date.now()-this.lastTeleport<500)){if(this.lastTeleport=Date.now(),this.lastTeleportFrom=t,this.lastTeleportTo=e,e?(o=e.getPosition()).y+=.5:(o.x=this.startPosition.x,o.y=this.startPosition.y,o.z=this.startPosition.z),!0===i){var l=.3*Math.random();o.x+=Math.random()>.5?-l:l}this.entity.rigidbody.teleport(o),this.entity.rigidbody.linearVelocity=this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO,this.entity.fire("teleportable:reposition")}};var Main=pc.createScript("main");Main.attributes.add("totalBalls",{type:"number",title:"Total Balls",description:"Number of balls thrown in a game",default:0}),Main.attributes.add("scoreEntity",{type:"entity",title:"Score-Keeping Text Entity"}),Main.attributes.add("ballCountEntity",{type:"entity",title:"Ball-Counting Text Entity"}),Main.attributes.add("messageEntity",{type:"entity",title:"Message Text Entity"}),Main.prototype.initialize=function(){void 0!==window.totalBalls&&(this.totalBalls=window.totalBalls),this.score=0,this.initGame=!0,this.totalBalls+=1,this.checkGameOver=this.checkGameOver.bind(this),this.alertRestart=this.alertRestart.bind(this),this.showMessage=this.showMessage.bind(this),this.hideMessage=this.hideMessage.bind(this),this.restartGame=this.restartGame.bind(this),window.restartGame=this.restartGame,this.app.keyboard.on(pc.EVENT_KEYDOWN,this.resetPosition,this),this.restartGame(),this.setBallCount(this.totalBalls),this.initGame=!1},Main.prototype.resetPosition=function(t){!0===this.gameOver&&t.key===pc.KEY_R&&this.restartGame(),t.event.preventDefault()},Main.prototype.restartGame=function(t){this.gameOver=!1,this.setBallCount(this.initGame?this.totalBalls+1:this.totalBalls-1),this.setScore(0),this.hideMessage(),this.recordedRollsArray=[],setTimeout(this.alertRestart,10)},Main.prototype.alertRestart=function(){this.app.fire("app:restartGame")},Main.prototype.changeBallCount=function(t){this.ballsLeft=Math.max(0,this.ballsLeft+t),1===this.ballsLeft&&this.blink(this.ballCountEntity),this.setBallCount(this.ballsLeft)},Main.prototype.setBallCount=function(t){this.ballsLeft=t;var e=!0===window.MobileFuse.PC_CONFIG.spanish?"PELOTA":"BALL";this.ballCountEntity&&(this.ballCountEntity.element.text=this.ballsLeft+" "+e+(1!==this.ballsLeft?"S":""))},Main.prototype.checkGameOver=function(t){if(0===this.ballsLeft&&!1===this.gameOver){this.gameOver=!0,this.app.fire("app:gameOver"),this.blink(this.scoreEntity),this.blink(this.ballCountEntity),window.MobileFuse.sendMessage("gameOver");var e=!0===window.MobileFuse.PC_CONFIG.spanish?"FIN DE LA\nPARTIDA":"GAME\nOVER";this.gameOverMessage=this.showMessage(e,-1)}},Main.prototype.setScore=function(t){this.score=t,this.scoreEntity&&(this.scoreEntity.element.text=this.score)},Main.prototype.showMessage=function(t,e){void 0===e&&(e=1.5),this.messageEntity&&(this.messageEntity.element.text=t,this.messageEntity.enabled=!0,e>0&&setTimeout(this.hideMessage,1e3*e))},Main.prototype.hideMessage=function(){this.messageEntity&&(this.messageEntity.enabled=!1)},Main.prototype.blink=function(t){var e=0;!function toggle(){e++,m=t.model||t.element,m.enabled=e%2==1,e<9&&setTimeout(toggle,250)}()};var Teleport=pc.createScript("teleport");Teleport.attributes.add("target",{type:"entity",title:"Target Entity",description:"The target entity where we are going to teleport"}),Teleport.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},Teleport.prototype.onTriggerEnter=function(t){this.app.fire("app:teleportRequest",t)};var SwitchingTextures=pc.createScript("switchingTextures");SwitchingTextures.attributes.add("textures",{type:"asset",assetType:"texture",array:!0,title:"Textures"}),SwitchingTextures.attributes.add("changeOnSpin",{type:"boolean",default:!1,title:"Change On Spin",description:"Whether textures should be re-assigned as the entity spins"}),SwitchingTextures.attributes.add("emissive",{type:"boolean",default:!1,title:"Emissive?",description:"Whether the textures should be assigned as emissive"}),SwitchingTextures.prototype.initialize=function(){this.setInitialTextures=this.setInitialTextures.bind(this),this.initializeTextureAssignment=this.initializeTextureAssignment.bind(this),setTimeout(this.initializeTextureAssignment,50)},SwitchingTextures.prototype.initializeTextureAssignment=function(){try{this.configTextureData=window.MobileFuse.PC_CONFIG.textures,this.app.loader.getHandler("texture").crossOrigin="anonymous",this.changeOnSpin=!0===this.configTextureData.changeOnSpin,this.loadedTextures=0,this.texturesArray=[],this.entity.texturesLoaded=!1,this.emissive=!0===this.configTextureData.emissive,this.alertReady=this.alertReady.bind(this),Array.isArray(this.configTextureData.imageNames[0])?this.imageNamesArray=this.configTextureData.imageNames[this.entity.baseEntityIndex].slice():this.imageNamesArray=this.configTextureData.imageNames.slice();for(var t=0;t<this.imageNamesArray.length;t++){var e=new pc.Asset("texture_"+this.entity.baseEntityIndex+"-"+t,"texture",{url:this.configTextureData.imageFolder+this.imageNamesArray[t]});this.app.assets.add(e),e.on("load",this.externalImageLoadCompleteHandler,this),e.on("error",this.externalImageLoadErrorHandler,this),this.app.assets.load(e)}}catch(t){this.texturesArray=this.textures.slice(),setTimeout(this.setInitialTextures,50)}},SwitchingTextures.prototype.externalImageLoadCompleteHandler=function(t){var e=Number(t.name.split("-")[1]);this.texturesArray[e]=this.textures[e]=t,this.loadedTextures++,this.loadedTextures==this.imageNamesArray.length&&this.setInitialTextures()},SwitchingTextures.prototype.externalImageLoadErrorHandler=function(t){console.log(t)},SwitchingTextures.prototype.setInitialTextures=function(){if(this.entity._children[0].model)for(var t=Math.min(this.texturesArray.length,this.entity._children.length),e=0;e<t;e++){var i=this.entity._children[e];i.model.material=i.model.material.clone(),i.model.material.ambientTint=!1,this.setFaceTexture(e)}else{this.entity.model.material=this.entity.model.material.clone(),this.entity.model.material.ambientTint=!1;var s=!0===this.emissive?"emissiveMap":"diffuseMap",a=this.imageNamesArray[0];this.entity.model.material[s]=this.texturesArray[0].resource,this.entity.model.material[s].anisotropy=7,a.indexOf(".png")===a.length-4&&(this.entity.model.material.opacityMap=this.texturesArray[textureIndex].resource,this.entity.model.material.opacityMapChannel="a",this.entity.model.material.blendType=pc.BLEND_NORMAL),this.entity.model.material.update()}this.addRotationListeners(),this.entity.texturesLoaded=!0,setTimeout(this.alertReady,100)},SwitchingTextures.prototype.alertReady=function(){this.app.fire("textures:ready")},SwitchingTextures.prototype.setFaceTexture=function(t,e){void 0===e&&(e=t);var i=this.entity._children[t],s=!0===this.emissive?"emissiveMap":"diffuseMap",a=this.imageNamesArray[e];i.model.material[s]=this.texturesArray[e].resource,a.indexOf(".png")===a.length-4&&(i.model.material.opacityMap=this.texturesArray[e].resource,i.model.material.opacityMapChannel="a",i.model.material.blendType=pc.BLEND_NORMAL),i.model.material.update(),this.texturesArray.length>this.entity._children.length&&(i.model.entity.clickID="Plane_"+this.entity.baseEntityIndex+"-"+this.textures.indexOf(this.texturesArray[e]))},SwitchingTextures.prototype.addRotationListeners=function(){this.changeOnSpin&&this.entity._children.length<this.texturesArray.length&&this.entity.script.rotationTracker&&(this.frontPlaneIndex=0,this.app.on("rotationTracker:forward",this.forwardRotationHandler,this),this.app.on("rotationTracker:backward",this.backwardRotationHandler,this))},SwitchingTextures.prototype.forwardRotationHandler=function(t){t.entity.name===this.entity.name&&(this.texturesArray.push(this.texturesArray.shift()),this.updateTexturesOnRotation())},SwitchingTextures.prototype.backwardRotationHandler=function(t){t.entity.name===this.entity.name&&(this.texturesArray.unshift(this.texturesArray.pop()),this.updateTexturesOnRotation())},SwitchingTextures.prototype.updateTexturesOnRotation=function(){this.setFaceTexture(this.frontPlaneIndex,1),this.frontPlaneIndex=1===this.frontPlaneIndex?0:1,this.setFaceTexture(this.frontPlaneIndex,0)};var Follow=pc.createScript("follow");Follow.attributes.add("target",{type:"entity",title:"Target",description:"The Entity to follow"}),Follow.attributes.add("distance",{type:"number",title:"Distance",description:"How far from the Entity should the follower be"}),Follow.prototype.initialize=function(){var t=this.entity.getPosition();this.vec=new pc.Vec3(t.x,t.y,t.z)},Follow.prototype.update=function(t){if(this.target){var i=this.target.getPosition();i.x-=.01*this.distance,i.y+=2*this.distance,i.z+=2.5*this.distance,this.vec.lerp(this.vec,i,.1),this.entity.setPosition(this.vec)}};var Score=pc.createScript("score");Score.attributes.add("points",{type:"number",title:"Points Value",description:"Number of points that collision with this entitiy is worth",default:0}),Score.attributes.add("scoreIndicator",{type:"entity",title:"Score Indicator",description:"Score Indicator Entity, blinks when triggered"}),Score.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.app.on("app:gameOver",this.killBlink,this)},Score.prototype.onTriggerEnter=function(){var t,i,e=this;this.points>0&&this.app.fire("app:score",this.points),void 0!==this.scoreIndicator&&(t=this.scoreIndicator,i=0,function blink(){i++,(t.model||t.element).enabled=i%2==1,i<7&&(e.blinkTimeout=setTimeout(blink,200))}())},Score.prototype.killBlink=function(){clearTimeout(this.blinkTimeout),this.scoreIndicator&&((this.scoreIndicator.model||this.scoreIndicator.element).enabled=!0)};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this},from:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=0===this.duration?1:this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceIn=function(t){return 1-BounceOut(1-t)},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,n=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();